<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>QS Global Academic Survey</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>

  <style>
    body{
      background: url("background.webp") no-repeat center center fixed;
      background-size: cover;
    }

    .form-card{
      background:#fff;
      border-radius:10px;
      padding:25px;
      box-shadow:0 0 10px rgba(0,0,0,.1);
    }

    label span{color:red}

    /* ===== UNIVERSITY HEADER ===== */
    .jus-header{
      border-radius:8px;
      padding:20px;
      margin-bottom:25px;
    }

    .jus-header-inner{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:20px;
    }

    .jus-logo img{
      width:80px;
      height:80px;
      object-fit:contain;
    }

    .jus-text{
      text-align:left;
      line-height:1.4;
    }

    .jus-title{
      color:#0d6efd;
      font-size:26px;
      font-weight:700;
    }

    .jus-subtitle{
      color:#0d6efd;
      font-size:16px;
      margin-top:4px;
    }

    .jus-forms{
      color:#000;
      font-size:16px;
      margin-top:6px;
    }

    /* ===== QS STRIP HEADER (LIKE IMAGE) ===== */
    .qs-header{
      background:#cfe8f3;
      color:#2a6f8f;
      font-size:28px;
      font-weight:500;
      padding:18px 25px;
      border-radius:6px;
      margin-bottom:20px;
    }
  </style>
</head>

<body>

<div class="container my-4">
  <div class="form-card">

    <!-- ===== UNIVERSITY HEADER ===== -->
    <div class="jus-header">
      <div class="jus-header-inner">
        <!-- TEXT LEFT -->
        <div class="jus-text">
          <div class="jus-title">Irbid National University</div>
          <div class="jus-subtitle">Deanship of Academic Development and Quality Assurance</div>
          <div class="jus-forms">Electronic Forms</div>
        </div>

        <!-- LOGO RIGHT -->
        <div class="jus-logo">
          <img src="logo.jpg" alt="Logo">
        </div>
      </div>
    </div>

    <form id="surveyForm">

      <div class="qs-header">QS Global Academic Survey</div>

      <div class="row g-3">

        <div class="col-md-6">
          <label>Title <span>*</span></label>
          <select id="title" class="form-select" required>
            <option value="">Select</option>
            <option>Prof.</option>
            <option>Dr.</option>
            <option>Mr.</option>
            <option>Ms.</option>
          </select>
        </div>

        <div class="col-md-6">
          <label>Phone</label>
          <input id="phone" class="form-control" placeholder="">
        </div>

        <div class="col-md-6">
          <label>First Name <span>*</span></label>
          <input id="firstName" class="form-control" required>
        </div>

        <div class="col-md-6">
          <label>Last Name <span>*</span></label>
          <input id="lastName" class="form-control" required>
        </div>

        <div class="col-md-6">
          <label>Email <span>*</span></label>
          <input id="email" type="email" class="form-control" required>
        </div>

        <div class="col-md-6">
          <label>Language <span>*</span></label>
          <select id="language" class="form-select" required>
            <option value="Arabic">Arabic</option>
            <option value="English">English</option>
          </select>
        </div>

        <div class="col-md-6">
          <label>Department <span>*</span></label>
          <input id="department" class="form-control" required>
        </div>

        <div class="col-md-6">
          <label>Institution <span>*</span></label>
          <input id="institution" class="form-control" required>
        </div>

        <div class="col-md-6">
          <label>Location</label>
          <select id="location" class="form-select select2">
            <option value="Jordan">Jordan</option>
            <option value="UAE">UAE</option>
            <option value="Saudi Arabia">Saudi Arabia</option>
          </select>
        </div>

        <div class="col-md-6">
          <label>Consent <span>*</span></label>
          <select id="consent" class="form-select" required>
            <option value="">Select</option>
            <option value="Yes">Yes. I consent for Irbid National University to share my contact with QS Intelligence Unit</option>
            <option value="No">No. I do not consent for Irbid National University to share my contact with QS Intelligence Unit</option>
          </select>
        </div>

        <div class="col-md-12">
          <label>Name of person who asked you to complete this form <span>*</span></label>
          <select id="askedBy" class="form-select" required>
            <option value="">Select</option>
            <option>Prof. Majed Abu-Zreig</option>
            <option>Prof. Mohamed Ibrahim Mugableh</option>
          </select>
        </div>

      </div>

      <!-- Buttons -->
      <div class="mt-4 d-flex justify-content-end gap-2 flex-wrap">
        <button type="button" id="downloadExcel" class="btn btn-success px-4">
          Download Excel
        </button>

        <button type="button" id="clearData" class="btn btn-outline-danger px-4">
          Clear Data
        </button>
      </div>

    </form>

  </div>
</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<script>
$('.select2').select2({ width: '100%' });

const STORAGE_KEY = "qs_survey_rows_v1";

function v(id){
  const el = document.getElementById(id);
  return el ? el.value.trim() : "";
}

function getRows(){
  try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]"); }
  catch(e){ return []; }
}

function setRows(rows){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(rows));
}

function makeRow(){
  return {
    "Title": v("title"),
    "Phone": v("phone"),
    "First Name": v("firstName"),
    "Last Name": v("lastName"),
    "Email": v("email"),
    "Language": v("language"),
    "Department": v("department"),
    "Institution": v("institution"),
    "Location": v("location"),
    "Consent": v("consent"),
    "Asked By": v("askedBy"),
    "Submitted At": new Date().toLocaleString()
  };
}

/* ===== Download = Save + Export ===== */
document.getElementById("downloadExcel").addEventListener("click", function(){

  const row = makeRow();

  // Validate required fields
  if(!row["Title"] || !row["First Name"] || !row["Last Name"] || !row["Email"] ||
     !row["Language"] || !row["Department"] || !row["Institution"] ||
     !row["Consent"] || !row["Asked By"]) {
    alert("Please fill all required fields (*)");
    return;
  }

  // Save
  const rows = getRows();
  rows.push(row);
  setRows(rows);

  // Export
  const ws = XLSX.utils.json_to_sheet(rows);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "Survey");
  XLSX.writeFile(wb, "QS_Survey_All_Responses.xlsx");

  // Reset form
  document.getElementById("surveyForm").reset();
  $('.select2').val(null).trigger('change');

  alert("✅ Saved & Downloaded successfully!");
});

/* ===== Clear all saved data ===== */
document.getElementById("clearData").addEventListener("click", function(){
  if(getRows().length === 0){
    alert("No saved data to clear.");
    return;
  }
  if(!confirm("Are you sure you want to delete all saved responses?")) return;

  localStorage.removeItem(STORAGE_KEY);
  alert("✅ All saved responses deleted.");
});
</script>


</body>
</html>
